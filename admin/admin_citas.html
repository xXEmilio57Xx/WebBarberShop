<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración de Citas | Barbería El Negrito</title>
    <link rel="shortcut icon" href="../img/ChairIcon.ico" type="image/x-icon">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">Admin BarberShop</a>
        </div>
    </nav>

    <div class="container mt-5">
        <h2 class="mb-4">Gestión de Citas</h2>
        <table class="table table-striped table-bordered" id="tablaCitas">
            <thead class="table-dark">
                <tr>
                    <th>Cliente</th>
                    <th>Barbero</th>
                    <th>Fecha</th>
                    <th>Hora</th>
                    <th>Servicio</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <!-- Las citas se cargan aquí con JS -->
            </tbody>
        </table>
    </div>

    <!-- Modal Editar Cita -->
    <div class="modal fade" id="modalEditarCita" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Cita</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarCita">
                        <input type="hidden" id="edit_id_cita" name="id_cita">
                        <div class="mb-3">
                            <label for="edit_cliente" class="form-label">Cliente</label>
                            <input type="text" id="edit_cliente" class="form-control" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="edit_barbero" class="form-label">Barbero</label>
                            <select id="edit_barbero" name="id_barbero" class="form-control" required>
                                <!-- Opciones cargadas desde JS -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit_fecha" class="form-label">Fecha</label>
                            <input type="date" id="edit_fecha" name="fecha_cita" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="edit_hora" class="form-label">Hora</label>
                            <input type="time" id="edit_hora" name="hora_cita" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="edit_servicio" class="form-label">Servicio</label>
                            <input type="text" id="edit_servicio" name="servicio" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="edit_estado" class="form-label">Estado</label>
                            <select id="edit_estado" name="estado" class="form-control" required>
                                <option value="pendiente">pendiente</option>
                                <option value="completada">completada</option>
                                <option value="cancelada">cancelada</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success">Actualizar Cita</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS y Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JS de manejo de citas -->
    <script src="citas_admin.js"></script>

    <script>
    // Función eliminar cita
    function eliminarCita(id) {
        if (!confirm("¿Desea eliminar esta cita?")) return;

        const datos = new FormData();
        datos.append("id_cita", id);

        fetch("eliminar_cita.php", {
            method: "POST",
            body: datos
        })
        .then(res => res.json())
        .then(respuesta => {
            alert(respuesta.message);
            cargarCitas();
        })
        .catch(err => console.error("Error al eliminar cita:", err));
    }
    </script>
</body>
</html>
